{
    "devNotes": "more profiling were added for time cost model",
    "computation_profiling": {
        "layernum[6]_bsz2": 77.27328643798828,
        "layernum[12]_bsz2": 143.17074584960938,
        "layertype_0": 4.789421272277832,
        "layernum[2]_bsz2": 31.147062301635746,
        "layernum[4]_bsz2": 54.69291191101074,
        "layernum[2]_bsz8": 109.32056350708005,
        "layernum[4]_bsz8": 194.11891174316403,
        "layernum[2]_bsz1": 18.34820804595947,
        "layernum[2]_bsz3": 44.21484451293946,
        "layernum[2]_bsz4": 56.972291564941415,
        "layernum[2]_bsz5": 72.85300216674804,
        "layernum[2]_bsz6": 86.12442932128906,
        "layernum[2]_bsz7": 96.37412567138674,
        "layernum[2]_bsz9": 125.0731384277344,
        "layernum[2]_bsz10": 138.55611572265624,
        "layernum[2]_bsz11": 152.41731567382814,
        "layernum[2]_bsz12": 162.45811767578127,
        "layernum[2]_bsz13": 178.4720306396484,
        "layernum[2]_bsz14": 189.28246612548827,
        "layernum[4]_bsz1": 30.91028499603272,
        "layernum[4]_bsz3": 77.54770202636718,
        "layernum[4]_bsz4": 99.15223999023438,
        "layernum[4]_bsz5": 124.74575653076172,
        "layernum[4]_bsz6": 145.07332458496094,
        "layernum[4]_bsz7": 167.81986389160159,
        "layernum[4]_bsz9": 214.1194534301758,
        "layernum[4]_bsz10": 237.16009979248045,
        "layernum[4]_bsz11": 260.8160919189453,
        "layernum[4]_bsz12": 284.8269073486328,
        "layernum[4]_bsz13": 307.13702087402345,
        "layernum[4]_bsz14": 332.1334320068359,
        "layertype_0_bsz1": 6.281038475036624,
        "layertype_other_0_bsz1": 5.786131095886223,
        "layertype_0_bsz2": 5.886462402343748,
        "layertype_other_0_bsz2": 3.800606346130376,
        "layertype_0_bsz3": 5.555476252237953,
        "layertype_other_0_bsz3": 3.627328999837246,
        "layertype_0_bsz4": 5.27249355316162,
        "layertype_other_0_bsz4": 3.698085784912113,
        "layertype_0_bsz5": 5.189275436401369,
        "layertype_other_0_bsz5": 4.192049560546872,
        "layertype_0_bsz6": 4.912407938639324,
        "layertype_other_0_bsz6": 4.529255676269528,
        "layertype_0_bsz7": 5.1032670157296325,
        "layertype_other_0_bsz7": 3.5611982073102695,
        "layertype_0_bsz8": 5.299896764755249,
        "layertype_other_0_bsz8": 3.065276908874509,
        "layertype_0_bsz9": 4.947017500135633,
        "layertype_other_0_bsz9": 4.002980380588114,
        "layertype_0_bsz10": 4.9301992034912105,
        "layertype_other_0_bsz10": 3.9952131652832037,
        "layertype_0_bsz11": 4.927217102050779,
        "layertype_other_0_bsz11": 4.00168540261009,
        "layertype_0_bsz12": 5.0986995697021475,
        "layertype_other_0_bsz12": 3.3407773335774777,
        "layertype_0_bsz13": 4.948653470552886,
        "layertype_other_0_bsz13": 3.8313108004056438,
        "layertype_0_bsz14": 5.10182021004813,
        "layertype_other_0_bsz14": 3.3165357317243314
    },
    "memory_profiling": {
        "layertype_0_sp": {
            "8192": {
                "parameter_size": 1860.3134765625,
                "tp_activation_per_bsz_dict": {
                    "1": 2373.3759765625,
                    "2": 1226.68798828125,
                    "4": 613.343994140625,
                    "8": 306.6719970703125,
                    "checkpoint": 80.0
                }
            }
        },
        "other_memory_pp_off_sp": {
            "8192": {
                "model_states": {
                    "1": 24272.5859375,
                    "2": 12777.158203125,
                    "4": 6709.1181640625,
                    "8": 3675.09814453125
                },
                "activation": {
                    "1": 5422.232421875,
                    "2": 2340.117919921875,
                    "4": 1077.4146728515625,
                    "8": 515.6724243164062
                }
            }
        },
        "other_memory_pp_on_first_sp": {
            "8192": {
                "model_states": {
                    "1": 12009.0009765625,
                    "2": 6645.02001953125,
                    "4": 3675.02001953125,
                    "8": 1837.510009765625
                },
                "activation": {
                    "1": 938.4945068359375,
                    "2": 376.50506591796875,
                    "4": 188.53656005859375,
                    "8": 94.26828002929688
                }
            }
        },
        "other_memory_pp_on_last_sp": {
            "8192": {
                "model_states": {
                    "1": 12009.0791015625,
                    "2": 6645.09814453125,
                    "4": 3675.09814453125,
                    "8": 1837.549072265625
                },
                "activation": {
                    "1": 4676.8231201171875,
                    "2": 2245.7345581054688,
                    "4": 1123.2504272460938,
                    "8": 561.6252136230469
                }
            }
        }
    },
    "model_config": {
        "dim": 5120,
        "ffn_dim": 27648,
        "multiple_of": 256,
        "n_heads": 40,
        "n_layers": 64,
        "n_kv_heads": 8,
        "norm_eps": 1e-05,
        "vocab_size": 152064,
        "n_positions": 131072
    }
}